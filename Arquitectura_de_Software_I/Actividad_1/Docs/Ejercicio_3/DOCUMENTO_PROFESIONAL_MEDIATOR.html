<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patrón Mediator - Sistema de Chat Grupal</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        
        .document {
            background-color: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .title {
            color: #2c3e50;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 16px;
            font-style: italic;
        }
        
        .author-info {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 24px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        h2 {
            color: #34495e;
            font-size: 20px;
            margin-top: 25px;
            margin-bottom: 12px;
        }
        
        h3 {
            color: #34495e;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .toc h2 {
            color: #2c3e50;
            margin-top: 0;
            border: none;
            padding: 0;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .toc li:before {
            content: "▶";
            color: #3498db;
            position: absolute;
            left: 0;
        }
        
        .highlight-box {
            background-color: #e8f4fd;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .problem-box {
            background-color: #fdf2e9;
            border-left: 4px solid #e67e22;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .solution-box {
            background-color: #eafaf1;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background-color: #34495e;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        .comparison-table td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .comparison-table tr:hover {
            background-color: #e8f4fd;
        }
        
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .benefit-card {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .benefit-card h3 {
            color: #27ae60;
            margin-top: 0;
        }
        
        .benefit-card .icon {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .architecture-diagram {
            background-color: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .architecture-diagram h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        
        .conclusion {
            background-color: #e8f5e8;
            border: 1px solid #27ae60;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }
        
        .conclusion h2 {
            color: #27ae60;
            margin-top: 0;
        }
        
        .page-break {
            page-break-before: always;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
            color: #7f8c8d;
            font-size: 12px;
        }
        
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        
        li {
            margin: 5px 0;
        }
        
        strong {
            color: #2c3e50;
        }
        
        em {
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="document">
        <div class="header">
            <div class="title">Patrón Mediator</div>
            <div class="subtitle">Sistema de Chat Grupal - Análisis e Implementación</div>
        </div>
        
        <div class="author-info">
            <strong>Universidad</strong> | Arquitectura de Software<br>
            <em>Taller de Patrones de Diseño - Ejercicio 3</em>
        </div>

        <div class="toc">
            <h2>Tabla de Contenidos</h2>
            <ul>
                <li>Introducción</li>
                <li>Análisis del Escenario</li>
                <li>Justificación del Patrón Mediator</li>
                <li>Implementación de la Solución</li>
                <li>Arquitectura del Sistema</li>
                <li>Beneficios Obtenidos</li>
                <li>Características Avanzadas</li>
                <li>Conclusiones</li>
            </ul>
        </div>

        <h1>1. Introducción</h1>
        
        <p>Este documento presenta el análisis, diseño e implementación de un <strong>sistema de chat grupal</strong> utilizando el <strong>Patrón Mediator</strong> de diseño. El proyecto demuestra cómo este patrón arquitectónico resuelve eficazmente los problemas de comunicación compleja entre múltiples objetos en un entorno de chat colaborativo.</p>
        
        <div class="highlight-box">
            <strong>Objetivo Principal:</strong> Demostrar la aplicación práctica del Patrón Mediator para resolver problemas de alta dependencia y acoplamiento en sistemas de comunicación multi-objeto.
        </div>

        <h1>2. Análisis del Escenario</h1>
        
        <h2>2.1 Problema Original</h2>
        
        <p>En un sistema de chat grupal tradicional, cada usuario necesitaría mantener referencias directas a todos los demás participantes, generando una red compleja de dependencias que presenta múltiples desafíos:</p>
        
        <div class="problem-box">
            <h3>Problemas Identificados:</h3>
            <ul>
                <li><strong>Alta dependencia:</strong> Cada usuario debe conocer a todos los demás</li>
                <li><strong>Dificultad de escalabilidad:</strong> Agregar/eliminar usuarios requiere modificar múltiples clases</li>
                <li><strong>Lógica dispersa:</strong> La gestión de comunicación está distribuida en cada usuario</li>
                <li><strong>Mantenimiento complejo:</strong> Cambios en la comunicación afectan múltiples componentes</li>
            </ul>
        </div>

        <h2>2.2 Complejidad sin Mediator</h2>
        
        <p>En un sistema sin mediador, la complejidad de las relaciones crece exponencialmente:</p>
        
        <div class="architecture-diagram">
            <h3>Estructura Problemática (Sin Mediator)</h3>
            <p><strong>Usuario A ↔ Usuario B ↔ Usuario C ↔ Usuario D</strong></p>
            <p><em>Complejidad: O(n²) dependencias</em></p>
        </div>

        <h1>3. Justificación del Patrón Mediator</h1>
        
        <h2>3.1 Comparación con Otros Patrones</h2>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Patrón</th>
                    <th>Ventajas</th>
                    <th>Desventajas para este escenario</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Observer</strong></td>
                    <td>Desacoplamiento parcial</td>
                    <td>No centraliza la lógica de comunicación</td>
                </tr>
                <tr>
                    <td><strong>Command</strong></td>
                    <td>Encapsula operaciones</td>
                    <td>No resuelve la comunicación entre objetos</td>
                </tr>
                <tr>
                    <td><strong>Facade</strong></td>
                    <td>Simplifica interfaz</td>
                    <td>No maneja interacciones complejas</td>
                </tr>
                <tr>
                    <td><strong>Mediator</strong></td>
                    <td>✅ Centraliza comunicación<br>✅ Reduce acoplamiento<br>✅ Facilita escalabilidad</td>
                    <td>Complejidad inicial</td>
                </tr>
            </tbody>
        </table>

        <h2>3.2 Razones de Elección del Mediator</h2>
        
        <div class="benefits-grid">
            <div class="benefit-card">
                <div class="icon">🎯</div>
                <h3>Centralización</h3>
                <p>Toda la lógica de comunicación está en un solo lugar</p>
            </div>
            <div class="benefit-card">
                <div class="icon">🔗</div>
                <h3>Desacoplamiento</h3>
                <p>Los usuarios no conocen entre sí, solo al mediador</p>
            </div>
            <div class="benefit-card">
                <div class="icon">📈</div>
                <h3>Escalabilidad</h3>
                <p>Agregar/eliminar usuarios es trivial</p>
            </div>
            <div class="benefit-card">
                <div class="icon">🛠️</div>
                <h3>Mantenibilidad</h3>
                <p>Cambios en la comunicación se realizan en un solo punto</p>
            </div>
        </div>

        <h1>4. Implementación de la Solución</h1>
        
        <h2>4.1 Estructura de Clases</h2>
        
        <div class="code-block">
// Interfaz del Mediador
public interface IChatMediator
{
    void SendMessage(string from, string to, string message);
    void AddUser(User user);
}

// Implementación Básica
internal class ChatMediator : IChatMediator
{
    private readonly IDictionary&lt;string, User&gt; _users;
    // Implementación de la lógica de comunicación
}

// Implementación Avanzada con Reflexión
public class ReflectiveChatMediator : IChatMediator
{
    private readonly IDictionary&lt;string, User&gt; _users;
    private readonly IDictionary&lt;string, MethodInfo&gt; _messageHandlers;
    private readonly IDictionary&lt;string, object&gt; _participants;
    // Implementación con capacidades reflexivas
}
        </div>

        <h2>4.2 Participantes del Patrón</h2>
        
        <ol>
            <li><strong>Mediator (IChatMediator):</strong> Define la interfaz para comunicación</li>
            <li><strong>ConcreteMediator (ChatMediator/ReflectiveChatMediator):</strong> Implementa la lógica de comunicación</li>
            <li><strong>Colleague (User):</strong> Representa los usuarios del chat</li>
            <li><strong>ConcreteColleague (User):</strong> Implementación específica de usuario</li>
        </ol>

        <h1>5. Arquitectura del Sistema</h1>
        
        <h2>5.1 Flujo de Comunicación</h2>
        
        <div class="architecture-diagram">
            <h3>Flujo Simplificado con Mediator</h3>
            <p><strong>Usuario 1 → Mediador → Usuario 2</strong></p>
            <p><strong>Usuario 1 → Mediador → Usuario 3</strong></p>
            <p><strong>Usuario 1 → Mediador → Usuario 4</strong></p>
            <p><em>Complejidad: O(n) dependencias</em></p>
        </div>

        <h2>5.2 Componentes Principales</h2>
        
        <h3>ReflectiveChatMediator - Implementación Avanzada</h3>
        <ul>
            <li><strong>Reflexión:</strong> Uso de atributos para configuración automática</li>
            <li><strong>Handlers dinámicos:</strong> Métodos marcados con <code>[MediatorHandler]</code></li>
            <li><strong>Estadísticas:</strong> Recopilación automática de métricas</li>
            <li><strong>Logging:</strong> Registro de actividades del chat</li>
        </ul>

        <h3>User - Participante del Chat</h3>
        <div class="code-block">
[MediatorParticipant("ChatUser")]
public class User
{
    [MediatorProperty("NickName", true)]
    public string NickName { get; set; }
    
    [MediatorProperty("IsOnline")]
    public bool IsOnline { get; set; }
    
    // Métodos de comunicación a través del mediador
}
        </div>

        <h1>6. Beneficios Obtenidos</h1>
        
        <h2>6.1 Beneficios Esperados (Cumplidos)</h2>
        
        <div class="solution-box">
            <h3>✅ 1. Facilita el Mantenimiento</h3>
            <p><strong>Antes:</strong> Modificar comunicación requería cambios en múltiples clases</p>
            <p><strong>Después:</strong> Cambios centralizados en el mediador</p>
            <p><strong>Ejemplo:</strong> Agregar filtro de mensajes solo requiere modificar el mediador</p>
        </div>
        
        <div class="solution-box">
            <h3>✅ 2. Mejor Organización</h3>
            <p><strong>Antes:</strong> Lógica de comunicación dispersa en cada usuario</p>
            <p><strong>Después:</strong> Lógica centralizada y bien estructurada</p>
            <p><strong>Ejemplo:</strong> Manejo de usuarios offline, logs, estadísticas en un solo lugar</p>
        </div>
        
        <div class="solution-box">
            <h3>✅ 3. Reduce la Complejidad</h3>
            <p><strong>Antes:</strong> Red compleja de dependencias entre usuarios</p>
            <p><strong>Después:</strong> Estructura simple: Usuario ↔ Mediador ↔ Usuario</p>
            <p><strong>Ejemplo:</strong> Agregar 10 usuarios nuevos no requiere modificar usuarios existentes</p>
        </div>

        <h2>6.2 Beneficios Adicionales</h2>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Aspecto</th>
                    <th>Sin Mediator</th>
                    <th>Con Mediator</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Acoplamiento</strong></td>
                    <td>Alto (O(n²))</td>
                    <td>Bajo (O(n))</td>
                </tr>
                <tr>
                    <td><strong>Mantenimiento</strong></td>
                    <td>Difícil</td>
                    <td>Fácil</td>
                </tr>
                <tr>
                    <td><strong>Escalabilidad</strong></td>
                    <td>Limitada</td>
                    <td>Excelente</td>
                </tr>
                <tr>
                    <td><strong>Testabilidad</strong></td>
                    <td>Compleja</td>
                    <td>Simple</td>
                </tr>
            </tbody>
        </table>

        <h1>7. Características Avanzadas</h1>
        
        <h2>7.1 Sistema de Reflexión</h2>
        
        <div class="code-block">
// Configuración automática de propiedades
private void ConfigureParticipantProperties(object participant)
{
    var properties = participant.GetType().GetProperties()
        .Where(p => p.GetCustomAttribute&lt;MediatorPropertyAttribute&gt;() != null);
    // Configuración automática basada en atributos
}
        </div>

        <h2>7.2 Handlers Dinámicos</h2>
        
        <div class="code-block">
[MediatorHandler("broadcast", "Maneja mensajes enviados a todos los usuarios")]
private void HandleBroadcastMessage(string from, string to, string message)
{
    // Lógica específica para mensajes de difusión
}
        </div>

        <h2>7.3 Estadísticas y Monitoreo</h2>
        
        <div class="code-block">
public Dictionary&lt;string, object&gt; GetChatStatistics()
{
    return new Dictionary&lt;string, object&gt;
    {
        ["TotalUsers"] = _users.Count,
        ["TotalHandlers"] = _messageHandlers.Count,
        ["LastActivity"] = DateTime.Now
    };
}
        </div>

        <h1>8. Conclusiones</h1>
        
        <div class="conclusion">
            <h2>Resumen de la Implementación</h2>
            
            <p>El <strong>Patrón Mediator</strong> resultó ser la solución óptima para este escenario de chat grupal porque:</p>
            
            <ol>
                <li><strong>Resuelve el problema central:</strong> Elimina las dependencias directas entre usuarios</li>
                <li><strong>Centraliza la lógica:</strong> Toda la comunicación pasa por un punto único</li>
                <li><strong>Facilita la escalabilidad:</strong> Agregar/eliminar usuarios es trivial</li>
                <li><strong>Mejora el mantenimiento:</strong> Cambios se realizan en un solo lugar</li>
                <li><strong>Permite extensibilidad:</strong> Nuevas funcionalidades sin afectar usuarios existentes</li>
            </ol>
            
            <h3>Innovaciones Implementadas</h3>
            <ul>
                <li><strong>Mediador Reflexivo:</strong> Uso de atributos y reflexión para configuración automática</li>
                <li><strong>Handlers Dinámicos:</strong> Sistema de procesamiento de mensajes basado en atributos</li>
                <li><strong>Estadísticas Integradas:</strong> Monitoreo automático de la actividad del chat</li>
                <li><strong>Gestión de Estado:</strong> Control avanzado del estado de los participantes</li>
            </ul>
            
            <h3>Impacto en la Calidad del Código</h3>
            <ul>
                <li><strong>Acoplamiento:</strong> Reducido de alto a bajo</li>
                <li><strong>Cohesión:</strong> Aumentada significativamente</li>
                <li><strong>Mantenibilidad:</strong> Mejorada considerablemente</li>
                <li><strong>Escalabilidad:</strong> Excelente para crecimiento futuro</li>
                <li><strong>Testabilidad:</strong> Cada componente es independiente</li>
            </ul>
        </div>

        <div class="footer">
            <p>Documento generado para el análisis del Patrón Mediator en sistemas de chat grupal</p>
            <p>Universidad | Arquitectura de Software | Taller de Patrones de Diseño</p>
        </div>
    </div>
</body>
</html>
